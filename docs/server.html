<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pvp.server API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pvp.server</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import argparse
import re

from mesa.batchrunner import BatchRunner
from mesa.visualization.ModularVisualization import ModularServer
from mesa.visualization.modules import CanvasGrid, ChartModule, TextElement
from mesa.visualization.UserParam import UserSettableParameter

from .agents.block import Block
from .agents.citizen import Citizen
from .agents.cop import Cop
from .model import ProtestersVsPolice

# ap = argparse.ArgumentParser(&#34;Protesters Vs Police&#34;)
# ap.add_argument(&#34;-b&#34;, action=&#39;store_true&#39;,help=&#34;Batch runner&#34;)
# ags = ap.parse_args()

COP_COLOR = &#34;#000000&#34;
COP_ARRESTING_COLOR = &#34;#fcba03&#34;
AGENT_QUIET_COLOR = &#34;#0066CC&#34;
AGENT_REBEL_COLOR = &#34;#CC0000&#34;
AGENT_DEVIANT_COLOR = &#34;#00FBFF&#34;
JAIL_COLOR = &#34;#757575&#34;
BARRICADE_COLOR = &#34;#00FF00&#34;


def citizen_cop_portrayal(agent):
    if agent is None:
        return

    portrayal = {
        &#34;Shape&#34;: &#34;circle&#34;,
        &#34;x&#34;: agent.pos[0],
        &#34;y&#34;: agent.pos[1],
        &#34;Filled&#34;: &#34;true&#34;,
    }

    if type(agent) is Citizen:
        color = (
            AGENT_QUIET_COLOR if agent.condition == &#34;Quiescent&#34; else AGENT_REBEL_COLOR
        )
        color = AGENT_DEVIANT_COLOR if agent.condition == &#34;Deviant&#34; else color
        color = JAIL_COLOR if agent.jail_sentence else color
        portrayal[&#34;Color&#34;] = color
        portrayal[&#34;r&#34;] = 0.8
        portrayal[&#34;Layer&#34;] = 0

    elif type(agent) is Block:
        portrayal[&#34;Shape&#34;] = &#34;rect&#34;
        portrayal[&#34;Color&#34;] = BARRICADE_COLOR
        portrayal[&#34;h&#34;] = 0.9
        portrayal[&#34;w&#34;] = 0.9
        portrayal[&#34;Layer&#34;] = 0

    elif type(agent) is Cop:
        color = COP_COLOR if agent.can_arrest else COP_ARRESTING_COLOR
        portrayal[&#34;Color&#34;] = color
        portrayal[&#34;r&#34;] = 0.5
        portrayal[&#34;Layer&#34;] = 1
    return portrayal


model_params = {
    &#34;grid_density&#34;: UserSettableParameter(
        param_type=&#34;slider&#34;,
        name=&#34;Grid density&#34;,
        value=0.8,
        min_value=0,
        max_value=1,
        step=0.01,
        description=&#34;&#34;,
    ),
    &#34;ratio&#34;: UserSettableParameter(
        param_type=&#34;slider&#34;,
        name=&#34;Citizen to cop ratio&#34;,
        value=0.8,
        min_value=0,
        max_value=1,
        step=0.001,
        description=&#34;&#34;,
    ),
    &#34;jail_capacity&#34;: UserSettableParameter(
        param_type=&#34;slider&#34;,
        name=&#34;Jail capacity&#34;,
        value=50,
        min_value=0,
        max_value=1000,
        step=1,
        description=&#34;&#34;,
    ),
    &#34;environment&#34;: UserSettableParameter(
        param_type=&#34;choice&#34;,
        name=&#34;Environment&#34;,
        value=&#34;Random distribution&#34;,
        choices=[
            &#34;Random distribution&#34;,
            &#34;Block in the middle&#34;,
            &#34;Cops in the middle&#34;,
            &#34;Wall of cops&#34;,
            &#34;Street&#34;,
            &#34;Clustered&#34;,
        ],
        description=&#34;&#34;,
    ),
    &#34;wrap&#34;: UserSettableParameter(
        param_type=&#34;choice&#34;,
        name=&#34;Wrap&#34;,
        value=&#34;Don&#39;t wrap around&#34;,
        choices=[&#34;Wrap around&#34;, &#34;Don&#39;t wrap around&#34;],
        description=&#34;&#34;,
    ),
    &#34;direction_bias&#34;: UserSettableParameter(
        param_type=&#34;choice&#34;,
        name=&#34;Citizen Direction&#34;,
        value=&#34;Random&#34;,
        choices=[
            &#34;Random&#34;,
            &#34;Clockwise&#34;,
            &#34;Anti-clockwise&#34;,
            &#34;left&#34;,
            &#34;right&#34;,
            &#34;up&#34;,
            &#34;down&#34;,
        ],
        description=&#34;&#34;,
    ),
    &#34;height&#34;: 40,
    &#34;width&#34;: 40,
    &#34;citizen_vision&#34;: 7,
    &#34;cop_vision&#34;: 7,
    &#34;legitimacy&#34;: 0.8,
    &#34;max_jail_term&#34;: 1000,
    &#34;barricade&#34;: 50,
    &#34;funmode&#34;: False,  # Set to True for sound effects
}


class AgentLeftElement(TextElement):
    &#34;&#34;&#34;
    Display a text count of how many agents there are.
    &#34;&#34;&#34;

    def __init__(self):
        pass

    def render(self, model):
        cop = 0
        citizen = 0
        block = 0
        for agent in model.schedule.agents:
            if agent.breed == &#34;citizen&#34;:
                citizen += 1
            if agent.breed == &#34;cop&#34;:
                cop += 1
            if agent.breed == &#34;Block&#34;:
                block += 1

        stats = f&#34;&#34;&#34;Number of citizens: {str(citizen)}, Number of jailed citizens: {str(len(model.jailed_agents))}, \n Number of cops: {str(cop)}, Number of blocks: {str(block)}, \n Average Aggression: {model.avg_agg}&#34;&#34;&#34;  # FIXME New lines somehow don&#39;t work?
        return stats


chart = ChartModule(
    [
        {&#34;Label&#34;: &#34;Quiescent&#34;, &#34;Color&#34;: AGENT_QUIET_COLOR},
        {&#34;Label&#34;: &#34;Active&#34;, &#34;Color&#34;: AGENT_REBEL_COLOR},
        {&#34;Label&#34;: &#34;Jailed&#34;, &#34;Color&#34;: JAIL_COLOR},
        {&#34;Label&#34;: &#34;Deviant&#34;, &#34;Color&#34;: AGENT_DEVIANT_COLOR},
    ],
    data_collector_name=&#34;datacollector&#34;,
)

# def batch_run(model):
# print(ags.b)
# if ags.b == True:
#     pass
# else:
canvas_element = CanvasGrid(citizen_cop_portrayal, 40, 40, 480, 480)
server = ModularServer(
    ProtestersVsPolice,
    [canvas_element, AgentLeftElement(), chart],
    &#34;Protesters vs Police&#34;,
    model_params,
)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pvp.server.citizen_cop_portrayal"><code class="name flex">
<span>def <span class="ident">citizen_cop_portrayal</span></span>(<span>agent)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def citizen_cop_portrayal(agent):
    if agent is None:
        return

    portrayal = {
        &#34;Shape&#34;: &#34;circle&#34;,
        &#34;x&#34;: agent.pos[0],
        &#34;y&#34;: agent.pos[1],
        &#34;Filled&#34;: &#34;true&#34;,
    }

    if type(agent) is Citizen:
        color = (
            AGENT_QUIET_COLOR if agent.condition == &#34;Quiescent&#34; else AGENT_REBEL_COLOR
        )
        color = AGENT_DEVIANT_COLOR if agent.condition == &#34;Deviant&#34; else color
        color = JAIL_COLOR if agent.jail_sentence else color
        portrayal[&#34;Color&#34;] = color
        portrayal[&#34;r&#34;] = 0.8
        portrayal[&#34;Layer&#34;] = 0

    elif type(agent) is Block:
        portrayal[&#34;Shape&#34;] = &#34;rect&#34;
        portrayal[&#34;Color&#34;] = BARRICADE_COLOR
        portrayal[&#34;h&#34;] = 0.9
        portrayal[&#34;w&#34;] = 0.9
        portrayal[&#34;Layer&#34;] = 0

    elif type(agent) is Cop:
        color = COP_COLOR if agent.can_arrest else COP_ARRESTING_COLOR
        portrayal[&#34;Color&#34;] = color
        portrayal[&#34;r&#34;] = 0.5
        portrayal[&#34;Layer&#34;] = 1
    return portrayal</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pvp.server.AgentLeftElement"><code class="flex name class">
<span>class <span class="ident">AgentLeftElement</span></span>
</code></dt>
<dd>
<div class="desc"><p>Display a text count of how many agents there are.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AgentLeftElement(TextElement):
    &#34;&#34;&#34;
    Display a text count of how many agents there are.
    &#34;&#34;&#34;

    def __init__(self):
        pass

    def render(self, model):
        cop = 0
        citizen = 0
        block = 0
        for agent in model.schedule.agents:
            if agent.breed == &#34;citizen&#34;:
                citizen += 1
            if agent.breed == &#34;cop&#34;:
                cop += 1
            if agent.breed == &#34;Block&#34;:
                block += 1

        stats = f&#34;&#34;&#34;Number of citizens: {str(citizen)}, Number of jailed citizens: {str(len(model.jailed_agents))}, \n Number of cops: {str(cop)}, Number of blocks: {str(block)}, \n Average Aggression: {model.avg_agg}&#34;&#34;&#34;  # FIXME New lines somehow don&#39;t work?
        return stats</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>mesa.visualization.modules.TextVisualization.TextElement</li>
<li>mesa.visualization.ModularVisualization.VisualizationElement</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pvp.server.AgentLeftElement.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<div class="desc"><p>Build visualization data from a model object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>model</code></strong></dt>
<dd>A model object</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>A JSON-ready object.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def render(self, model):
    cop = 0
    citizen = 0
    block = 0
    for agent in model.schedule.agents:
        if agent.breed == &#34;citizen&#34;:
            citizen += 1
        if agent.breed == &#34;cop&#34;:
            cop += 1
        if agent.breed == &#34;Block&#34;:
            block += 1

    stats = f&#34;&#34;&#34;Number of citizens: {str(citizen)}, Number of jailed citizens: {str(len(model.jailed_agents))}, \n Number of cops: {str(cop)}, Number of blocks: {str(block)}, \n Average Aggression: {model.avg_agg}&#34;&#34;&#34;  # FIXME New lines somehow don&#39;t work?
    return stats</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pvp" href="index.html">pvp</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pvp.server.citizen_cop_portrayal" href="#pvp.server.citizen_cop_portrayal">citizen_cop_portrayal</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pvp.server.AgentLeftElement" href="#pvp.server.AgentLeftElement">AgentLeftElement</a></code></h4>
<ul class="">
<li><code><a title="pvp.server.AgentLeftElement.render" href="#pvp.server.AgentLeftElement.render">render</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>